\section{Algebraic proof of correctness}
\begin{proof}
We have shown that during the entire computation, the state of the algorithm is a linear combination of $\ket{\psi}$ and $\ket{\beta}$. We can write the action of $\hat{U_\psi}$ and $\hat{U}_\beta$ in the space spanned by $\{\ket{\beta}, \ket{\psi}\}$ as\footnote{We are assuming $M=1$ through all the proof.}:
\begin{align*}
    &\hat{U}_\psi : a\ket{\beta} + b\ket{\psi} \rightarrow [\ket{\beta}\ket{\psi}] \begin{bmatrix}
    -1 & 0 \\
    2/\sqrt{N} & 1
    \end{bmatrix} 
    \begin{bmatrix}
    a \\
    b
    \end{bmatrix} \\
    &\hat{U}_\beta : a\ket{\beta} + b\ket{\psi} \rightarrow [\ket{\beta}\ket{\psi}] \begin{bmatrix}
    -1 & -2/\sqrt{N} \\
    0 & 1
    \end{bmatrix} 
    \begin{bmatrix}
    a \\
    b
    \end{bmatrix} 
\end{align*}
In the basis $\{\ket{\beta}, \ket{\psi}\}$\footnote{This basis is neither orthogonal nor a basis of the whole space.} the operator $\hat{U_\psi}\hat{U}_\beta$ is given by the matrix:
\begin{equation*}
    \hat{U}_\psi\hat{U}_\beta = \begin{bmatrix}
    -1 & 0 \\
    2/\sqrt{N} & 1
    \end{bmatrix} 
    \begin{bmatrix}
    -1 & -2/\sqrt{N} \\
    0 & 1
    \end{bmatrix}  =
    \begin{bmatrix}
    1 & 2/\sqrt{N} \\
    -2/\sqrt{N} & 1-4\sqrt{N}
    \end{bmatrix} 
\end{equation*}
The matrix, with $\frac{\theta}{2} = \arcsin{\frac{1}{\sqrt{N}}}$ obtained from~\ref{eq:beta-projection}, has the following Jordan form
\begin{equation*}
    \hat{U}_\psi\hat{U}_\beta = M  \begin{bmatrix}
    e^{i\theta} & 0 \\
    0 & e^{-i\theta}
    \end{bmatrix}  M^{-1} \quad \text{where} \quad M = \begin{bmatrix}
    -i & i \\
    e^{i\theta/2} & e^{-i\theta/2}
    \end{bmatrix}
  \end{equation*}
 with $M$ being the matrix diagonalizing the operators. It follows that after R iterations we have
\begin{equation*}
    (\hat{U_\psi}\hat{U}_\beta)^R = M  \begin{bmatrix}
    e^{Ri\theta} & 0 \\
    0 & e^{-Ri\theta}
    \end{bmatrix}  M^{-1}.
\end{equation*}
Using this form, we can use trigonometric identities to compute the probability of observing $\beta$ after $R$ iterations

\begin{equation*}
   \abs*{ [\braket{\beta | \beta} \braket{\beta | \psi}]
     (\hat{U_\psi}\hat{U}_\beta)^R \begin{bmatrix}
     0 \\ 1
     \end{bmatrix} }^2= \sin^2\biggl(\frac{2R+1}{2}\theta\biggr)
\end{equation*}

and we will show in section~\ref{sec:performance} that the observation yields the correct answer $\beta$ with error $\mathcal{O}(\frac{1}{N})$.
\end{proof}